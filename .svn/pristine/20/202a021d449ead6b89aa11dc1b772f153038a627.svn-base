package com.aixu.meeting.service;

import java.util.Date;
import java.util.List;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.stereotype.Service;

import com.aixu.meeting.dao.AikoDeptMapper;
import com.aixu.meeting.dao.AikoUserMapper;
import com.aixu.meeting.domain.AikoDept;
import com.aixu.meeting.domain.AikoUser;
import com.aixu.meeting.domain.AikoUserExample;

@Service
public class UserService {
	
	private static final Logger LOGGER = LoggerFactory.getLogger(UserService.class);
	
	@Autowired
	private AikoUserMapper userDAO;
	
	@Autowired
	private AikoDeptMapper deptDAO;
	
	public List<AikoUser> listAllUser () {
		AikoUserExample example = new AikoUserExample();
		example.createCriteria().andStatusEqualTo(1);
		List<AikoUser> alUser = userDAO.selectByExample(example);
		System.out.println(alUser.size());
		for (AikoUser aikoUser : alUser) {
			AikoDept dept = deptDAO.selectByPrimaryKey(aikoUser.getDeptid());
			if(dept == null){
				dept = new AikoDept("23", "23", "23", "23", "23", "23", "23",
						new Date(), "23", new Date(), "23", 23, "23");
				
			}
			aikoUser.setDeptName(dept.getName()==null?"":dept.getName());
		}
		return alUser;
	}
	
	/**
	 * 根据工号查询员工
	 * @param no
	 * @return
	 */
	public AikoUser getUserByNo(String no) {
		AikoUserExample example = new AikoUserExample();
		example.createCriteria().andUseridEqualTo(no);
		AikoUser aikoUser = userDAO.selectByExample(example).get(0);
		return aikoUser;
	}
	
	/**
	 * 根据部门编号查询员工
	 * @param deptId
	 * @return
	 */
	public List<AikoUser> listUserByDeptId(String deptId) {
		AikoUserExample example = new AikoUserExample();
		example.createCriteria().andDeptidEqualTo(deptId).andStatusEqualTo(1);
		List<AikoUser> userByDept = userDAO.selectByExample(example);
		return userByDept;
	}
	
	/**
	 * 模糊查询
	 * @param keyWord 关键字
	 * @return 用户列表
	 */
	public List<AikoUser> listUserLikeKeyWord(String keyWord) {
		AikoUserExample example = new AikoUserExample();
		example.createCriteria().andNameLike(keyWord);
		List<AikoUser> userList = userDAO.selectByExample(example);
		return userList;
	}
	
	/**
	 * @return in内部的工号员工
	 */
	public List<AikoUser> listUserByMyNo() {
		return userDAO.getUserByMyNo();
	}
	
}
 